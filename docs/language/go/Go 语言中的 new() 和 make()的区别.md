# Go 语言中的 new() 和 make()的区别

---

## 概述

Go 语言中的 `new` 和 `make` 一直是新手比较容易混淆的东西，咋一看很相似。不过解释两者之间的不同也非常容易。 他们所做的事情，和应用的类型也不相同。
二者都是用来分配空间。

## new 函数

- `new` 是内建函数，函数原型为：

```go

func new(Type) *Type

```

>内置函数 `new` 分配空间。传递给 `new` 函数的是一个 **类型**，不是一个值。返回值是 指向这个新分配的零值的 **指针**。

## make函数

`make` 也是内函数，函数原型：

```go

func make(Type, size IntegerType) Type

```

- 第一个参数是一个类型，第二个参数是长度

- 返回值是一个类型

>内建函数 `make` 分配并且初始化 一个 slice, 或者 map 或者 chan 对象。 并且只能是这三种对象。 和 `new` 一样，第一个参数是 类型，不是一个值。 但是 `make` 的返回值就是这个类型（即使一个引用类型），而不是指针。 具体的返回值，依赖具体传入的类型。

>内建函数 make 分配并且初始化 一个 slice, 或者 map 或者 chan 对象。 并且只能是这三种对象。 和 new 一样，第一个参数是 类型，不是一个值。 但是make 的返回值就是这个类型（即使一个引用类型），而不是指针。 具体的返回值，依赖具体传入的类型。

## 总结

`new` 的作用是 初始化 一个指向类型的指针 (*T)， `make` 的作用是为 `slice`, `map` 或者 `channel` 初始化，并且返回引用 T

`make(T, args)` 函数的目的与 `new(T)` 不同。它仅仅用于创建 Slice, Map 和 Channel，并且返回类型是 T（不是T*）的一个初始化的（不是零值）的实例。 这中差别的出现是由于这三种类型实质上是 **对在使用前必须进行初始化的数据结构的引用**。 例如, Slice是一个 具有三项内容的描述符，包括 指向数据（在一个数组内部）的指针，长度以及容量。在这三项内容被初始化之前，Slice的值为nil。对于Slice，Map和Channel， make（）函数初始化了其内部的数据结构，并且准备了将要使用的值。

